<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Contato — BrazilTrad</title>
  <link rel="stylesheet" href="css/style.css">

  <style>
    body {
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: #f1f5f4;
      padding: 40px 10px;
    }
    .container {
      max-width: 520px;
      margin: 0 auto;
      background: #fff;
      padding: 30px;
      border-radius: 14px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.07);
      text-align: center;
    }
    h1 {
      margin-bottom: 5px;
      color: #0F4C5C;
      font-size: 26px;
    }
    p.subtitle {
      margin-bottom: 25px;
      color: #444;
    }
    label {
      display: block;
      text-align: left;
      font-weight: 600;
      margin-top: 12px;
    }
    input, textarea {
      width: 100%;
      padding: 12px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 15px;
    }
    button {
      width: 100%;
      margin-top: 18px;
      padding: 14px;
      background: #0F4C5C;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 15px;
      font-weight: 600;
    }
    button:hover { background: #12697a; }
    #msgStatus {
      margin-top: 18px;
      font-weight: 600;
      text-align: center;
    }
    .success { color: #008f4c; }
    .error { color: #c62828; }
    #backBtn {
      display: none;
      margin-top: 16px;
      background: #0F4C5C;
    }
  </style>
</head>

<body>

  <div class="container">

    <h1>Contato</h1>
    <p class="subtitle">Preencha o formulário abaixo e entraremos em contacto.</p>

    <form id="contactForm">

      <!-- Web3Forms -->
      <input type="hidden" name="access_key" value="36b646fd-5467-4ff8-8a3a-9df90aae76fe">

      <!-- Removido auto_response simples -->
      <!-- Aqui colocaremos o auto_response_html dinamicamente via JS -->

      <!-- Email interno -->
      <input type="hidden" name="from_name" value="BrazilTrad - Website">
      <input type="hidden" name="subject" value="Novo contato recebido pelo site BrazilTrad">

      <!-- Campos -->
      <label for="name">Nome *</label>
      <input type="text" id="name" name="name" required>

      <label for="email">E-mail *</label>
      <input type="email" id="email" name="email" required>

      <label for="company">Empresa (opcional)</label>
      <input type="text" id="company" name="company">

      <label for="message">Mensagem *</label>
      <textarea id="message" name="message" rows="5" required></textarea>

      <button type="submit">Enviar</button>

      <div id="msgStatus"></div>
      <button id="backBtn" onclick="history.back()">Voltar ao site</button>

    </form>
  </div>

<script>
document.getElementById("contactForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const form = e.target;
  const msg = document.getElementById("msgStatus");
  msg.textContent = "";
  msg.className = "";

  // Criar auto_response_html PO COM HTML BONITO
  const autoResponseHTML = `
    <html>
      <body style="font-family:Arial,sans-serif;color:#333;">
        <h2 style="color:#0F4C5C;">Obrigado pelo seu contato, ${form.name.value}!</h2>
        <p>Recebemos sua mensagem e retornaremos em breve.</p>
        <hr>
        <p style="font-size:12px;color:#666;">BrazilTrad — Exportação & Comércio Internacional</p>
      </body>
    </html>
  `;

  const formData = new FormData(form);
  // AUTO-REPLY HTML CORRETO
formData.append("auto_reply_html", autoResponseHTML);

// GARANTE QUE O DESTINATÁRIO É O LEAD
formData.append("reply_to", form.email.value);

  try {
    // 1️⃣ Enviar ao Web3Forms (2 e-mails: interno + lead)
    const resEmail = await fetch("https://api.web3forms.com/submit", {
      method: "POST",
      body: formData
    });

    const jsonEmail = await resEmail.json();
    if (!jsonEmail.success) throw new Error("email_error");

    // 2️⃣ Enviar ao Zoho
    const zohoPayload = new FormData();
    zohoPayload.append("Company", form.company.value);
    zohoPayload.append("Last Name", form.name.value);
    zohoPayload.append("Email", form.email.value);
    zohoPayload.append("Description", form.message.value);
    zohoPayload.append("Lead Source", "Contato Site");

    await fetch(
      "https://crm.zoho.com/crm/WebToLeadForm?xnQsjsdp=3fd1731c66fbf93ea4e8cba470a7d2c3236fa48b9105a4c2e169800c6460cf13&xmIwtLD=55bb49f2537e4ee9c2c0d22cdebef9a489a974853af1926bb998412b493ac61ffb6464561e419055979737b7f25d38f3&actionType=TGVhZHM=&returnURL=null",
      {
        method: "POST",
        body: zohoPayload
      }
    );

    msg.textContent = "Mensagem enviada com sucesso!";
    msg.classList.add("success");
    document.getElementById("backBtn").style.display = "block";
    form.reset();

  } catch (err) {
    console.error(err);
    msg.textContent = "Erro ao enviar. Tente novamente.";
    msg.classList.add("error");
  }
});
</script>

</body>
</html>
