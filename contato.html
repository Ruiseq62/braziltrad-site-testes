<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Contato — BrazilTrad</title>
<style>
  body {
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background: #f1f5f4;
      padding: 40px 10px;
  }
  .container {
      max-width: 520px;
      margin: 0 auto;
      background: #fff;
      padding: 30px;
      border-radius: 14px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.07);
      text-align: center;
  }
  h1 { margin-bottom: 5px; color: #0F4C5C; font-size: 26px; }
  p.subtitle { margin-bottom: 25px; color: #444; }
  label { display:block; text-align:left; font-weight:600; margin-top:12px; }
  input, textarea {
      width:100%; padding:12px; margin-top:5px; border:1px solid #ccc;
      border-radius:6px; font-size:15px;
  }
  button { width:100%; margin-top:18px; padding:14px; background:#0F4C5C; color:#fff;
    border:none; border-radius:6px; cursor:pointer; font-size:15px; font-weight:600; }
  button:hover { background:#12697a; }
  #msgStatus { margin-top:18px; font-weight:600; text-align:center; }
  .success { color:#008f4c; }
  .error { color:#c62828; }
  #backBtn { display:none; margin-top:16px; background:#0F4C5C; color:#fff; border:none; padding:10px; border-radius:6px; cursor:pointer; }
  .small { font-size:13px; color:#666; margin-top:6px; }
</style>
</head>
<body>
  <div class="container">
    <h1>Contato</h1>
    <p class="subtitle">Preencha o formulário abaixo e entraremos em contato.</p>

    <form id="contactForm">
      <!-- Hidden Zoho-required fields (copiados do teu snippet do Zoho) -->
      <input type="hidden" name="xnQsjsdp" value="006d2ecb73ad998ea05f038497601dc3ffae95c11e530d1250cc6309dabfc502">
      <input type="hidden" name="xmIwtLD" value="0c16e695af92187629acdbe97f14dc0656f785e23f9449adbc346216ab10aaebe8d345eda125a27c49af0f12ee5c0f23">
      <input type="hidden" name="actionType" value="TGVhZHM=">
      <input type="hidden" name="zc_gad" id="zc_gad" value="">
      <!-- Return URL is kept as your site; we still use AJAX so return won't redirect -->
      <input type="hidden" name="returnURL" value="https://braziltrad.com">

      <!-- Form fields (user-visible) -->
      <label for="name">Nome *</label>
      <input type="text" id="name" name="Last Name" placeholder="Nome ou Apelido" required>

      <label for="email">E-mail *</label>
      <input type="email" id="email" name="Email" placeholder="teu@exemplo.com" required>

      <label for="phone">Telefone *</label>
      <input type="text" id="phone" name="Mobile" placeholder="+55..." required>

      <label for="country">País de Atuação *</label>
      <input type="text" id="country" name="City" placeholder="País / Região" required>

      <label for="company">Empresa (opcional)</label>
      <input type="text" id="company" name="Company" placeholder="Empresa">

      <label for="message">Mensagem *</label>
      <textarea id="message" name="Description" rows="5" required></textarea>

      <!-- hidden mapping extras (Industry/Lead Source/etc) - optional but present -->
      <input type="hidden" id="industry" name="Industry" value="-None-">
      <input type="hidden" id="lead_source" name="Lead Source" value="-None-">
      <input type="hidden" id="annual_revenue" name="Annual Revenue" value="">
      <!-- Rating (Idioma) will be auto-filled by JS -->
      <input type="hidden" id="rating" name="Rating" value="PT">

      <button type="submit">Enviar</button>

      <div id="msgStatus" role="status" aria-live="polite"></div>
      <button id="backBtn" type="button" onclick="location.href='https://braziltrad.com'">Voltar ao site</button>
      <div class="small">Ao enviar, os dados entram diretamente no Zoho CRM.</div>
    </form>
  </div>

<script>
/*
  Funcionamento:
  - Detecta idioma do navegador e define Rating (PT/EN/ES/ZH)
  - Envia os campos diretamente para o endpoint do Zoho WebToLead via fetch + FormData
  - Em caso de sucesso (resposta 200) mostra mensagem e botão voltar
  - Em caso de erro, mostra erro
*/

(function(){
  // Configurações
  const ZOHO_URL = 'https://crm.zoho.com/crm/WebToLeadForm';

  function detectLangCode() {
    // tenta document.lang, senão navigator.language
    const lang = (document.documentElement.lang || navigator.language || navigator.userLanguage || 'pt').toLowerCase();
    if (lang.startsWith('pt')) return 'PT';
    if (lang.startsWith('es')) return 'ES';
    if (lang.startsWith('zh')) return 'ZH';
    if (lang.startsWith('en')) return 'EN';
    // default
    return 'PT';
  }

  // preenche o rating (idioma) automaticamente
  document.getElementById('rating').value = detectLangCode();

  // Envio via AJAX (fetch)
  const form = document.getElementById('contactForm');
  const statusDiv = document.getElementById('msgStatus');
  const backBtn = document.getElementById('backBtn');

  function setStatus(text, cls){
    statusDiv.textContent = text;
    statusDiv.className = cls || '';
  }

  form.addEventListener('submit', async function(e){
    e.preventDefault();
    setStatus('', '');

    // validação simples (nome + email + telefone)
    const name = form.querySelector('[name="Last Name"]').value.trim();
    const email = form.querySelector('[name="Email"]').value.trim();
    const phone = form.querySelector('[name="Mobile"]').value.trim();
    const country = form.querySelector('[name="City"]').value.trim();
    const message = form.querySelector('[name="Description"]').value.trim();

    if (!name) { setStatus('Nome é obrigatório.', 'error'); return; }
    if (!email || email.indexOf('@') === -1) { setStatus('Indique um e-mail válido.', 'error'); return; }
    if (!phone) { setStatus('Telefone é obrigatório.', 'error'); return; }
    if (!country) { setStatus('País de atuação é obrigatório.', 'error'); return; }
    if (!message) { setStatus('Mensagem é obrigatória.', 'error'); return; }

    // Desactivar botão enviar para evitar duplicados
    const btn = form.querySelector('button[type="submit"]');
    btn.disabled = true;
    btn.textContent = 'A enviar...';

    // monta FormData tal como o Zoho espera
    const fd = new FormData(form);

    // adiciona referer / deteção do idioma extra (opcional)
    fd.append('referer', document.referrer || window.location.href);
    fd.append('detected_language', document.documentElement.lang || navigator.language || '');

    try {
      const res = await fetch(ZOHO_URL, {
        method: 'POST',
        body: fd,
        mode: 'cors',
        credentials: 'omit'
      });

      // Zoho devolve HTML; assumimos sucesso se status OK (200)
      if (res.ok) {
        setStatus('Mensagem enviada com sucesso!', 'success');
        form.reset();
        // re-definir idioma após reset
        document.getElementById('rating').value = detectLangCode();
        backBtn.style.display = 'inline-block';
      } else {
        // tenta ler texto de erro do servidor
        let txt = 'Erro ao enviar. Tente novamente.';
        try { txt = await res.text(); } catch(e){}
        console.error('Zoho response:', res.status, txt);
        setStatus('Erro ao enviar. Tente novamente.', 'error');
      }
    } catch (err) {
      console.error('Erro fetch:', err);
      setStatus('Erro na ligação. Verifique a sua internet e tente outra vez.', 'error');
    } finally {
      btn.disabled = false;
      btn.textContent = 'Enviar';
    }
  });
})();
</script>
</body>
</html>
